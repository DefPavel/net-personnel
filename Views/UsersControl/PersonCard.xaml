<UserControl x:Class="AlphaPersonel.Views.PersonCard"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:viewmodels="clr-namespace:AlphaPersonel.ViewModels"
	xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
	xmlns:heplper="clr-namespace:AlphaPersonel.Helpers"
    heplper:InputBindingsBehavior.TakesInputBindingPrecedence="True"
    d:DataContext="{d:DesignInstance Type=viewmodels:PersonCardViewModel}"
    mc:Ignorable="d" 
    FontSize="13"         
    d:DesignHeight="950" d:DesignWidth="1100">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{ Binding LoadedListPerson }"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="23"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="20"/>
        </Grid.RowDefinitions>
        <!--#region COLUMNS MAIN GRID -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" MinWidth="250"/>
            <!-- Side Bar -->
            <ColumnDefinition/>
            <!-- Content -->
        </Grid.ColumnDefinitions>
        <!--#endregion-->
        <!--#region Menu -->
        <Menu 
            FontSize="13"
            Background="White"
            Grid.Row="0" 
            VerticalAlignment="Top"
            Grid.ColumnSpan="2">
            <MenuItem>
                <MenuItem.Header>
                    <StackPanel
                        HorizontalAlignment="Center"
                        Orientation="Horizontal">
                        <Canvas 
                           
                        Height="13"
                        Width="13">
                            <Path
                              
                            Stretch="Uniform"
                            Fill="#444444"
                            Data="M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"
                            Width="13" 
                            Height="13" />
                        </Canvas>
                        <TextBlock>Файл</TextBlock>
                    </StackPanel>
                </MenuItem.Header>
                <MenuItem Header="Поиск" Command="{Binding OpenSearch}"/>
                <MenuItem Header="Настройки"></MenuItem>
                <Separator/>
                <MenuItem Header="Выход из аккаунта" Command="{Binding Logout}"/>
            </MenuItem>
            <MenuItem 
                IsEnabled="{Binding IsAdministrator}">
                <MenuItem.Header>
                    <StackPanel 
                        HorizontalAlignment="Center"
                        Orientation="Horizontal">
                        <Canvas 
                        Height="13"
                        Width="13">
                            <Path
                            Stretch="Uniform"
                            Fill="#444444"
                            Data="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"
                            Width="13" 
                            Height="13" />
                        </Canvas>
                        <TextBlock>Справочники</TextBlock>
                    </StackPanel>
                </MenuItem.Header>
                <MenuItem Header="Список подразделений"
                          Command="{Binding OpenDepartment}" />
                <MenuItem Header="Виды должностей"
                          Command="{Binding OpenTypePosition}"/>
                <MenuItem Header="Виды отпусков"
                          Command="{Binding OpenVacation}"/>
                <MenuItem Header="Виды приказов"
                          Command="{Binding OpenTypeOrder}"/>
                <MenuItem Header="Виды награждений"
                          Command="{Binding OpenRewarding}"/>
                <MenuItem Header="Виды званий"
                          Command="{Binding OpenTypeRanks}"/>
                <MenuItem Header="Периоды отпусков"
                          Command="{Binding OpenPeriod}"/>
                <MenuItem Header="Список приказов" 
                          Command="{Binding OpenOrder}"/>
                <MenuItem Header="Список штатных должностей"
                          Command="{Binding OpenPosition}"/>
                <MenuItem Header="Мастер увольнений"
                          IsEnabled="True"
                          Command="{Binding OpenMasterDrop}"/>
                <!--<MenuItem Header="Календарь праздников"
                          Command="{Binding }"/>-->
                <!--<MenuItem Header="Отправка в отпуск..."/>-->
            </MenuItem>
            <MenuItem
                IsEnabled="{Binding IsAdministrator}">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Canvas 
                        Height="13"
                        Width="13">
                            <Path
                            Stretch="Uniform"
                            Fill="#444444"
                            Data="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M7,20H9V14H7V20M11,20H13V12H11V20M15,20H17V16H15V20Z"
                            Width="13" 
                            Height="13" />
                        </Canvas>
                        <TextBlock>Отчеты</TextBlock>
                    </StackPanel>
                </MenuItem.Header>
                <MenuItem 
                    Command="{Binding OpenReportInsert}"
                    Header="Список принятых сотрудников за период"/>
                <MenuItem 
                    Command="{Binding OpenReportInsertOther}"
                    Header="Список принятых сотрудников(Совместители) за период"/>
                <MenuItem 
                    Command="{Binding OpenReportRewarding}"
                    Header="Список награжденных сотрудников за период"/>
                <MenuItem 
                    Command="{Binding OpenReportDelete}"
                    Header="Список уволенных сотрудников за период"/>
                <MenuItem 
                    Command="{Binding OpenReportDeleteOther}"
                    Header="Список уволенных сотрудников(Совместители) за период"/>
                <MenuItem 
                    Command="{Binding OpenReportVacation}"
                    Header="Список сотрудников не имеющие отпуск за период"/>
                <MenuItem 
                    Command="{Binding OpenReportContract}"
                    Header="Истечении срока действия трудового договора"/>
                <MenuItem 
                    Command="{Binding OpenReportContractIsPluralism}"
                    Header="Истечении срока действия трудового договора(Совместители)"/>
                <MenuItem 
                    Command="{Binding OpenReportJubilee}"
                    Header="Список сотрудников Юбиляров"/>
                <MenuItem 
                    Header="Списки..." 
                    Command="{Binding OpenReport}"/>
            </MenuItem>
            <MenuItem 
                Background="White"
                Command="{Binding OpenMasterReport}"
                IsEnabled="{Binding IsAdministrator}">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Canvas 
                            Height="13"
                            Width="13">
                            <Path
                                Stretch="Uniform"
                                Fill="#444444"
                                Data="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M7,20H9V14H7V20M11,20H13V12H11V20M15,20H17V16H15V20Z"
                                Width="13" 
                                Height="13" />
                        </Canvas>
                        <TextBlock>Параметрический отчет</TextBlock>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>
        </Menu>
        <!--#endregion-->
        <Separator 
            Grid.Row="1" 
            Grid.Column="0" 
            Grid.ColumnSpan="2"
            VerticalAlignment="Top"
            Background="{StaticResource BorderBrush}" Margin="0"/>
        <!--#region SideBar -->
        <Grid  
            Grid.Column="0"
            Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="30"/>
                <RowDefinition Height="30"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <StackPanel 
                Margin="5 5 5 0"
                Grid.Row="0">
                <Button
                    Command="{Binding GetBack}"
                    Content="Вернуться на главное"/>
                <Button
                    Command="{Binding LoadedListAll}"
                    Content="Отобразить всех"/>
            </StackPanel>
            <StackPanel 
                Margin="5 5 5 0"
                Orientation="Horizontal"
                Grid.Row="1">
                <RadioButton Margin="5 0 5 0" IsChecked="True" Content="Обе категории">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Checked">
                            <i:InvokeCommandAction Command="{ Binding GetPersonsToNppAll }"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </RadioButton>
                <RadioButton Margin="5 0 5 0"  Content="НПП">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Checked">
                            <i:InvokeCommandAction Command="{ Binding GetPersonsToNpp }"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </RadioButton>
                <RadioButton Margin="5 0 5 0" Content="РСП И ОП">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Checked">
                            <i:InvokeCommandAction Command="{ Binding GetPersonsToNotNpp }"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </RadioButton>
            </StackPanel>
            <StackPanel 
                Margin="5 0 5 0"
                Grid.Row="2">
                <Separator/>
                <TextBox
                    Text="{Binding FilterPerson , UpdateSourceTrigger=PropertyChanged}"/>
            </StackPanel>
            <!-- Пока что поставил Index Потому что не в какую не передаётся значение selectedItem из предыдущего VM -->
            <!-- По хорошему можно просто передать данный список и всё!Но пока не выходит,так что делаю через API -->
            <DataGrid
                Margin="10 5 10 5"
                 FontSize="14"
                IsReadOnly="True"
                x:Name="PersonGrid"
                ScrollViewer.IsDeferredScrollingEnabled="True"
                VirtualizingStackPanel.VirtualizationMode="Recycling"
                ItemsSource="{Binding CollectionPerson}"
                SelectedItem="{Binding SelectedPerson}" 
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                Grid.Row="3" 
                >
                <DataGrid.Resources>
                    <Style TargetType="{x:Type DataGridCell}">
                        <Style.Triggers>
                            <Trigger Property="DataGridCell.IsSelected" Value="True">
                                <Setter Property="Background" Value="#1e88e5" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Resources>
                <DataGrid.ContextMenu>
                    <ContextMenu>
                        <MenuItem 
                            IsEnabled="False"
                          Header="Обновить"
                            CommandParameter="{Binding SelectedPerson}"
                          Command="{Binding LoadedListPerson}"/>
                        <MenuItem 
                          Header="Сохранить в буффер"
                            CommandParameter="{Binding SelectedPerson}"
                          Command="{Binding CopyBuffer}"/>
                    </ContextMenu>
                </DataGrid.ContextMenu>
                <!-- TODO: При этом методе будет постоятнно ломаться поиск (переделай на метод click cell или что-то в этом духе)-->
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <i:InvokeCommandAction Command="{Binding GetInfo}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <DataGrid.Columns>
                    <DataGridTextColumn 
                        Width="*"
                        Header="ФИО" 
                        Binding="{Binding FullName}"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
        <!--#endregion-->
        <GridSplitter 
            Background="#bdbdbd"
            Width="4"
            Margin="0 0 0 5"
            Grid.Row="1" 
            Grid.Column="0"/>
        <!--#region Content -->
        <Grid 
            Grid.Row="1"
            Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="35"/>
                <RowDefinition Height="35"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="29"/>
            </Grid.RowDefinitions>
            <TextBlock 
                Grid.Row="0"
                HorizontalAlignment="Center"
                Style="{StaticResource Header20}">
                <TextBlock.Text>
                    <Binding Path="SelectedPerson.ArrayPosition[0].DepartmentName" />
                </TextBlock.Text>
            </TextBlock>
            <Separator
                VerticalAlignment="Bottom"
                Grid.Row="0"/>
            <TextBlock 
                Margin="5 0 0 0"
                Grid.Row="1"
                Text="{Binding SelectedPerson.FullName}"
                Style="{StaticResource Header20}"
                />
            <Separator 
                Grid.Row="2"
                VerticalAlignment="Top"/>
            <TabControl 
                Margin="5"
                Grid.Row="2">
                <!--#region Личная карта -->
                <TabItem 
                     FontSize="13"
                    Header="Личная карта">
                    <ScrollViewer IsDeferredScrollingEnabled="True">
                        <Grid Margin="5" FocusManager.FocusedElement="{Binding ElementName=TextFilerName}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="300"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <GroupBox
                            Grid.Row="0"
                            Margin="2"
                            Header="Основная информация" 
                            >
                                <Grid>
                                    <Grid.InputBindings>
                                        <KeyBinding
                                            Modifiers="Ctrl"
                                            Key="S"
                                            Command="{Binding SaveMainInfo}" 
                                        />
                                    </Grid.InputBindings>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <Border
                                        BorderBrush="#444444"
                                        Padding="2"
                                        Margin="5"
                                        BorderThickness="1">
                                            <Image 
                                            MinHeight="140"
                                            Source="{Binding SelectedPerson.Photo}"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Stretch="Fill"
                                            StretchDirection="DownOnly" >
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="MouseLeftButtonDown">
                                                        <i:InvokeCommandAction Command="{ Binding UploadPhoto }"/>
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                            </Image>
                                        </Border>
                                        <Label
                                            HorizontalAlignment="Center"
                                        Content="Дата приёма:"/>
                                        <DatePicker
                                        Padding="4 1"
                                        Margin="4 3"
                                        SelectedDate="{Binding SelectedPerson.DateWorking , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                        <Button 
                                            Command="{Binding SaveMainInfo}"
                                            VerticalAlignment="Bottom"
                                            Content="Сохранить"
                                            Width="110" />
                                    </StackPanel>
                                    <Grid 
                                        Grid.Column="1" 
                                        Margin="2">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <Label 
                                           
                                        Grid.Row="0"
                                        Content="Фамилия:" FontWeight="Normal"/>
                                        <Grid Grid.Row="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition Width="30"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox  
                                                Grid.Column="0"
                                            IsEnabled="False"
                                            Text="{Binding SelectedPerson.FirstName , UpdateSourceTrigger=PropertyChanged}"
                                            />
                                            <Button 
                                                Command="{Binding OpenChangeSurname}"
                                                Grid.Column="1">
                                                <Button.ToolTip>
                                                    <ToolTip>
                                                        Изменить фамилию
                                                    </ToolTip>
                                                </Button.ToolTip>
                                                <Canvas 
                                                        Height="13"
                                                        Width="13">
                                                    <Path
                                                        Stretch="Uniform"
                                                        Fill="#444444"
                                                        Data="M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.09 20.21,11.09 20.42,11.3L21.7,12.58C21.91,12.79 21.91,13.14 21.7,13.35M12,18.94L18.06,12.88L20.11,14.93L14.06,21H12V18.94M12,14C7.58,14 4,15.79 4,18V20H10V18.11L14,14.11C13.34,14.03 12.67,14 12,14M12,4A4,4 0 0,0 8,8A4,4 0 0,0 12,12A4,4 0 0,0 16,8A4,4 0 0,0 12,4Z"
                                                        Width="13" 
                                                        Height="13" />
                                                </Canvas>
                                            </Button>
                                        </Grid>
                                        <Label 
                                        Grid.Row="2"
                                        Content="Имя:"/>
                                        <TextBox
                                        
                                        Grid.Row="3"
                                        Text="{Binding SelectedPerson.MidlleName , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                        <Label 
                                        Grid.Row="4"
                                        Content="Отчество:"/>
                                        <TextBox
                                        Grid.Row="5"
                                        Text="{Binding SelectedPerson.LastName , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                        <Label 
                                        Grid.Row="6"
                                        Content="Пол:"/>
                                        <StackPanel
                                            Orientation="Horizontal"
                                            Grid.Row="7">
                                            <RadioButton 
                                                IsChecked="{Binding RadioIsMale}"
                                                Padding="2" Content="Мужчина"/>
                                            <RadioButton
                                                IsChecked="{Binding RadioIsFemale}"
                                                Padding="2" Content="Женщина"/>
                                        </StackPanel>
                                       
                                    </Grid>
                                    <Grid 
                                         Margin="2"
                                        Grid.Column="2">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="23"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="*"/>
                                            
                                        </Grid.RowDefinitions>
                                        <Label 
                                        Grid.Row="0"
                                        Content="Номер телефона Лугаком:"/>
                                        <TextBox
                                            x:Name="TextFilerName"
                                            Grid.Row="1"
                                            Text="{Binding SelectedPerson.PhoneLugakom , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                        <Label 
                                        Grid.Row="2"
                                        Content="Номер телефона MTC:"/>
                                        <TextBox
                                        Grid.Row="3"
                                        Text="{Binding SelectedPerson.PhoneUkraine , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                        <Label 
                                        Grid.Row="4"
                                        Content="Дата рождения"/>
                                        <DatePicker
                                        Padding="4 1"
                                        Margin="4 3"
                                        Grid.Row="5"
                                        SelectedDate="{Binding SelectedPerson.Birthday , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                        <Label 
                                        Grid.Row="6"
                                        Content="Текущий возраст"/>
                                        <TextBlock
                                            Grid.Row="7"
                                            Foreground="#B71C1C"
                                            Margin="5 0 0 0"
                                          
                                            FontWeight="Bold">
											<Run Text="Лет:"/>
											<Run Text="{Binding SelectedPerson.FullAge.Years}"/>
											<Run Text=";"/>
											<Run Text="Месяцев:"/>
											<Run Text="{Binding SelectedPerson.FullAge.Months}"/>
											<Run Text=";"/>
											<Run Text="Дней:"/>
											<Run Text="{Binding SelectedPerson.FullAge.Days}"/>
											<Run Text=";"/>
                                        </TextBlock>
                                        
                                        <TextBlock 
                                            Margin="3"
                                            Grid.Row="8"
                                            Text="Должность Внеш.совместителя">
                                            <TextBlock.Style>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedPerson.IsPluralismOter }" Value="False">
                                                            <Setter Property="Visibility" Value="Hidden"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>

                                        <TextBox 
                                            Text="{Binding SelectedPerson.PositionPluralist , UpdateSourceTrigger=PropertyChanged}"
                                            Margin="3"
                                            Padding="3"
                                            Grid.Row="9">
                                            <TextBox.Style>
                                                <Style TargetType="{x:Type TextBox}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedPerson.IsPluralismOter }" Value="False">
                                                            <Setter Property="Visibility" Value="Hidden"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBox.Style>
                                        </TextBox>

                                    </Grid>
                                </Grid>
                            </GroupBox>

                            <GroupBox
                                Margin="2"
                                Grid.Row="3"
                                Header="Описание">
                                <TextBox 
                                    FontSize="14"
                                    AcceptsReturn="True"  
                                    TextWrapping="Wrap"
                                    VerticalScrollBarVisibility="Auto"
                                    MinHeight="100"
                                    SpellCheck.IsEnabled="True" Language="ru-ru"
                                    
                                    Text="{Binding SelectedPerson.Description , UpdateSourceTrigger=PropertyChanged}"/>
                            </GroupBox>
                            <GroupBox 
                               
                           Margin="2"
                           Grid.Row="2"
                           Header="Кем является">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <CheckBox Content="Студент"
                                                  IsChecked="{Binding SelectedPerson.IsStudent ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Аспирант" 
                                                  IsChecked="{Binding SelectedPerson.IsGraduate ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Внешний совместитель" 
                                                  IsChecked="{Binding SelectedPerson.IsPluralismOter ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Мать одиночка" 
                                                  IsChecked="{Binding SelectedPerson.IssingleMother ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Мать двоих детей" 
                                                  IsChecked="{Binding SelectedPerson.IsTwoChildMother ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <CheckBox Content="Докторант" 
                                                  IsChecked="{Binding SelectedPerson.IsDoctor ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Паспорт РФ" 
                                                  IsChecked="{Binding SelectedPerson.IsRussion,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="СНИЛС" 
                                                  IsChecked="{Binding SelectedPerson.IsSnils ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Справка о несудимости" 
                                                  IsChecked="{Binding SelectedPerson.IsPreviosConvition ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <CheckBox Content="Метериально ответственное лицо" 
                                                  IsChecked="{Binding SelectedPerson.IsResponsible ,TargetNullValue={x:Null}}">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Click">
                                                    <i:InvokeCommandAction Command="{Binding UpdateStates}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                    </StackPanel>
                                </Grid>
                            </GroupBox>
                            <GroupBox 
                                Margin="2"
                                Grid.Row="1"
                                Header="Текущая должность">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition  Height="30"/>
                                        <RowDefinition  Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel 
                                        Margin="0 0 2 0"
                                        HorizontalAlignment="Right"
                                        Orientation="Horizontal">
                                        <Button Command="{Binding OpenAddPosition}">
                                            <Button.ToolTip>
                                                <ToolTip>
                                                    Создать новую должность
                                                </ToolTip>
                                            </Button.ToolTip>
                                            <Canvas 
                                                        Height="13"
                                                        Width="13">
                                                <Path
                                                        Stretch="Uniform"
                                                        Fill="#444444"
                                                        Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
                                                        Width="13" 
                                                        Height="13" />
                                            </Canvas>
                                        </Button>
               
                                        <Button Command="{Binding OpenChangePosition}">
                                            <Button.ToolTip>
                                                <ToolTip>
                                                    Изменить должность
                                                </ToolTip>
                                            </Button.ToolTip>
                                            <Canvas 
                                                        Height="13"
                                                        Width="13">
                                                <Path
                                                        Stretch="Uniform"
                                                        Fill="#444444"
                                                        Data="M21,9L17,5V8H10V10H17V13M7,11L3,15L7,19V16H14V14H7V11Z"
                                                        Width="13" 
                                                        Height="13" />
                                            </Canvas>
                                        </Button>
                                        <Button Command="{Binding OpenChangeDatePosition}">
                                            <Button.ToolTip>
                                                <ToolTip>
                                                    Продление контрактов
                                                </ToolTip>
                                            </Button.ToolTip>
                                            <Canvas 
                                                        Height="13"
                                                        Width="13">
                                                <Path
                                                        Stretch="Uniform"
                                                        Fill="#444444"
                                                        Data="M19,19H5V8H19M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M16.53,11.06L15.47,10L10.59,14.88L8.47,12.76L7.41,13.82L10.59,17L16.53,11.06Z"
                                                        Width="13" 
                                                        Height="13" />
                                            </Canvas>
                                        </Button>
                                        <Button 
                                            Command="{Binding OpenDropPosition}">
                                            <Button.ToolTip>
                                                <ToolTip>
                                                    Удалить должность
                                                </ToolTip>
                                            </Button.ToolTip>
                                            <Canvas 
                                                        Height="13"
                                                        Width="13">
                                                <Path
                                                        Stretch="Uniform"
                                                        Fill="#444444"
                                                        Data="M19,13H5V11H19V13Z"
                                                        Width="13" 
                                                        Height="13" />
                                            </Canvas>
                                        </Button>
                                    </StackPanel>
                                    <DataGrid 
                                        
                                        FontSize="14"
                                        Grid.Row="1"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                        AutoGenerateColumns="False"
                                        CanUserAddRows="False"
                                     SelectedItem="{Binding SelectedPosition}"
                                     ItemsSource="{Binding SelectedPerson.ArrayPosition}"
                                    Margin="5">
                                        <DataGrid.Resources>
                                            <Style TargetType="{x:Type DataGridCell}">
                                                <Style.Triggers>
                                                    <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                        <Setter Property="Background" Value="#1e88e5" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                            <!--<CollectionViewSource x:Key="ItemsTypeContract" Source="{Binding TypeContracts }" /><CollectionViewSource x:Key="ItemsTypePlace" Source="{Binding TypePlaceOfWorks }" /><CollectionViewSource x:Key="ItemsTypeDepartment" Source="{Binding Departments }" /><CollectionViewSource x:Key="ItemsTypePosition" Source="{Binding TypePositions }" /> -->
                                        </DataGrid.Resources>
                                        <DataGrid.Columns>
                                            <DataGridCheckBoxColumn   
                                                Width="30"        
                                                Binding="{Binding IsMain ,TargetNullValue={x:Null}}"
                                                Header="Осн.место"/>
                                            <DataGridTextColumn 
                                                Binding="{Binding DepartmentName}"
                                                Width="*"
                                                Header="Отдел"/>
                                            <DataGridTextColumn 
                                                Binding="{Binding Name}"
                                                Width="*"
                                                Header="Должность"/>
                                            <!--<DataGridComboBoxColumn 
                                                Width="*"
                                                Header="Отдел"
                                                SelectedValueBinding="{Binding DepartmentName , UpdateSourceTrigger=PropertyChanged}"
                                                SelectedValuePath="Name"
                                                DisplayMemberPath="Name"
                                                ItemsSource="{Binding Source={StaticResource ItemsTypeDepartment}}"/><DataGridComboBoxColumn 
                                                Width="*"
                                                Header="Должность"
                                                SelectedValueBinding="{Binding Name , UpdateSourceTrigger=PropertyChanged}"
                                                SelectedValuePath="Name"
                                                DisplayMemberPath="Name"
                                                ItemsSource="{Binding Source={StaticResource ItemsTypePosition}}"/>-->
                                            <DataGridTextColumn 
                                        Binding="{Binding StavkaBudget}"
                                                Width="90"
                                        Header="Число бюджет"/>
                                            <DataGridTextColumn 
                                                Width="90"
                                        Binding="{Binding StavkaNoBudget}"
                                        Header="Число внебюджет"/>
                                            <DataGridTextColumn 
                                        Binding="{Binding Phone}"
                                                Width="50"
                                        Header="Телефон"/>
                                            <DataGridTextColumn 
                                        Binding="{Binding Order}"
                                        Header="Приказ"/>
                                            <DataGridTextColumn 
                                        Binding="{Binding Contract}"
                                        Header="Вид контракта"/>
                                            <!--<DataGridComboBoxColumn 
                                                Header="Вид контракта"
                                                SelectedValueBinding="{Binding Contract , UpdateSourceTrigger=PropertyChanged}"
                                                SelectedValuePath="Name"
                                                DisplayMemberPath="Name"
                                                ItemsSource="{Binding Source={StaticResource ItemsTypeContract}}"/>-->
                                            <DataGridTemplateColumn Header="Дата заключения">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding DateStartContract, UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <DatePicker 
                                                            Margin="4 2" 
                                                            Padding="4 2"
                                                            SelectedDate="{Binding DateStartContract, UpdateSourceTrigger=PropertyChanged}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Дата окончания">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding DateEndContract, UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <DatePicker 
                                                            Margin="4 2" 
                                                            Padding="4 2"
                                                            SelectedDate="{Binding DateEndContract, UpdateSourceTrigger=PropertyChanged}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn 
                                        Binding="{Binding Place}"
                                        Header="Место работы"/>
                                            <!--<DataGridComboBoxColumn 
                                                Header="Место работы"
                                                SelectedValueBinding="{Binding Place , UpdateSourceTrigger=PropertyChanged}"
                                                SelectedValuePath="Name"
                                                DisplayMemberPath="Name"
                                                ItemsSource="{Binding Source={StaticResource ItemsTypePlace}}"/>-->
                                            <!--<DataGridTemplateColumn Header="Дата увольнения">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding DateDrop, UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                                <DataGridTemplateColumn.CellEditingTemplate>
                                                    <DataTemplate>
                                                        <DatePicker 
                                                            Margin="4 2" 
                                                            Padding="4 2"
                                                            SelectedDate="{Binding DateDrop, UpdateSourceTrigger=PropertyChanged}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellEditingTemplate>
                                            </DataGridTemplateColumn>-->
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </GroupBox>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
                <!--#endregion-->
                <!--#region Работа -->
                <TabItem 
                     FontSize="13"
                    Header="Работа">
                    <TabControl>
                        <TabItem Header="Служебные перемещения">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectionMode="Single"
                                     FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                     SelectedItem="{Binding SelectedMove}"
                                    ItemsSource="{Binding SelectedPerson.ArrayMove}"
                                    Margin="10">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridCheckBoxColumn 
                                            Binding="{Binding IsMain}"
                                            Header="Осн.место"/>
                                        <DataGridCheckBoxColumn 
                                            Binding="{Binding IsPed}"
                                            Header="Пед.должн."/>
                                        <!--Дата назначения -->
                                        <DataGridTemplateColumn Header="Дата назначения">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding CreatedAt, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding CreatedAt}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn
                                            Header="Отдел"
                                            Binding="{Binding Department}"
                                            />
                                        <DataGridTextColumn
                                            Header="Должность"
                                            Binding="{Binding Position}"
                                            />
                                        <DataGridTextColumn
                                            Header="Ставка бюджет"
                                            Binding="{Binding CountBudget}"
                                            />
                                        <DataGridTextColumn
                                            Header="Ставка вне бюджет"
                                            Binding="{Binding CountNoBudget}"
                                            />
                                        <DataGridTextColumn
                                            Header="№ Прикааз"
                                            Binding="{Binding Order}"
                                            />
                                        <DataGridTextColumn
                                            Header="Контракт"
                                            Binding="{Binding Contract}"
                                            />
                                        <DataGridTemplateColumn Header="Дата нач. контракта">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateStart, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateStart}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Дата окон. контракта">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateEnd, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateEnd}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn
                                            Header="Дней отпуска"
                                            Binding="{Binding Holiday}"
                                            />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter Grid.Column="0" Width="2"/>
                                <StackPanel 
                                    Grid.Column="1" 
                                    Margin="5">
                                    <Label Content="Отдел"/>
                                    <TextBox Text="{Binding SelectedMove.Department}"/>
                                    <Label Content="Должность"/>
                                    <TextBox Text="{Binding SelectedMove.Position}"/>
                                    <Label Content="№ Приказа"/>
                                    <TextBox Text="{Binding SelectedMove.Order}"/>
                                    <Label Content="Контракт"/>
                                    <TextBox Text="{Binding SelectedMove.Contract}"/>
                                    <Label Content="Ставка Бюджет"/>
                                    <TextBox Text="{Binding SelectedMove.CountBudget}"/>
                                    <Label Content="Ставка Внебюджет"/>
                                    <TextBox Text="{Binding SelectedMove.CountNoBudget}"/>
                                    <Label Content="Дата нач. контракта"/>
                                    <DatePicker 
                                        Padding="2" 
                                        SelectedDate="{Binding SelectedMove.DateStart}"/>
                                    <Label Content="Дата окон. контракта"/>
                                    <DatePicker 
                                        Padding="2"
                                        SelectedDate="{Binding SelectedMove.DateEnd}"/>
                                    <CheckBox 
                                        IsChecked="{Binding SelectedMove.IsMain}"
                                        Content="Осн. место работы" />
                                    <CheckBox 
                                        IsChecked="{Binding SelectedMove.IsPed}"
                                        Content="Педагогическая должность" />
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Отпуска">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid
                                    
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                     FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    SelectedItem="{Binding SelectedVacation}"
                                    ItemsSource="{Binding SelectedPerson.ArrayVacation}"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    Grid.Column="0"
                                    Margin="10">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        <CollectionViewSource x:Key="ItemsTypeVacations" Source="{Binding TypeVacation}" />
                                        <CollectionViewSource x:Key="ItemsPeriodVacations" Source="{Binding PeriodVacation}" />
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridComboBoxColumn 
                                            SelectedValueBinding="{Binding Type}"
                                            SelectedValuePath="Name"
                                            DisplayMemberPath="Name"
                                            ItemsSource="{Binding Source={StaticResource ItemsTypeVacations}}"
                                            Header="Тип отпуска"/>
                                        <DataGridComboBoxColumn 
                                            SelectedValueBinding="{Binding Period}"
                                            SelectedValuePath="Name"
                                            DisplayMemberPath="Name"
                                            ItemsSource="{Binding Source={StaticResource ItemsPeriodVacations}}"
                                            Header="Период отпуска"/>
                                        <DataGridTextColumn
                                            Binding="{Binding LengthVacation}"
                                            Header="Продолж.(дней)"/>
                                        <DataGridTemplateColumn Header="Дата начала">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateBegin, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateBegin}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Дата окончания">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateEnd, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateEnd}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>

                                        <DataGridTextColumn
                                            Binding="{Binding Order}"
                                            Header="Приказ"/>
                                        
                                       

                                        <!--<DataGridComboBoxColumn 
                                            SelectedValueBinding="{Binding Order}"
                                            SelectedValuePath="Order"
                                            DisplayMemberPath="Order"
                                            ItemsSource="{Binding Source={StaticResource ItemsOrderVacations}}"
                                            Header="Приказ"/>-->
                                        
                                        <DataGridTextColumn 
                                            Binding="{Binding Residue}"
                                            Header="Остаток"/>
                                        <DataGridTextColumn
                                            Binding="{Binding Description}"
                                            Header="Примечание"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter 
                                    Width="2"
                                    Grid.Column="0"/>
                                <StackPanel 
                                    Grid.Column="1"
                                    Margin="5">
                                    <Label Content="Выбрать Тип Отпуска"/>
                                    <ComboBox 
                                        MinWidth="100"
                                        IsEditable="True"
                                        ItemsSource="{Binding TypeVacation}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SelectedVacation.Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Выбрать Период Отпуска"/>
                                    <ComboBox 
                                        MinWidth="100"
                                        IsEditable="True"
                                        ItemsSource="{Binding PeriodVacation}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SelectedVacation.Period, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Выбрать Приказ"/>
                                    <ComboBox 
                                        MinWidth="100"
                                        IsEditable="True"
                                        ItemsSource="{Binding OrderVacations}"
                                        DisplayMemberPath="Order"
                                        SelectedValuePath="Order"
                                        SelectedValue="{Binding SelectedVacation.Order, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Дата начала Отпуска"/>
                                    <DatePicker 
                                        Padding="4 1"
                                        Margin="4 3"
                                        SelectedDate="{Binding SelectedVacation.DateBegin , UpdateSourceTrigger=PropertyChanged}"
                                    />
                                    <Label Content="Продолжительность Отпуска"/>
                                    <TextBox 
                                        Text="{Binding SelectedVacation.LengthVacation , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                    <Label Content="Остаток Отпуска"/>
                                    <TextBox 
                                        IsEnabled="False"
                                        Text="{Binding SelectedVacation.Residue , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                    <Label Content="Примечание"/>
                                    <TextBox 
                                        Text="{Binding SelectedVacation.Description , UpdateSourceTrigger=PropertyChanged}"
                                        />
                                    <StackPanel 
                                        
                                        Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddVacation}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveVacation}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteVacation}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                            
                            Header="Трудовая книга">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel 
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="2" 
                                    Orientation="Horizontal">
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж общий:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsOver}" 
                                        />
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж Науч-пед.:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsPedagogical}" 
                                        />
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж Научный:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsScience}" 
                                       />
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж в ЛГПУ:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsUniver}" 
                                        />
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж Библ.:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsLibrary}" 
                                        />
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж Музея:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsMuseum}" 
                                        />
                                    <TextBlock 
                                        Margin="5 0 0 0"
                                        Text="Стаж Мед.:" 
                                        FontWeight="Bold"/>
                                    <TextBlock 
                                        Foreground="#B71C1C"
                                        Margin="5 0 0 0"
                                        Text="{Binding StageIsMedical}" 
                                        />
                                </StackPanel>
                                <DataGrid 
                                    ScrollViewer.CanContentScroll="True" 
                                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                     FontSize="14"
                                    
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    SelectedItem="{Binding SelectedHistory}"
                                    AlternatingRowBackground="#ECEFF1"
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.HistoryEmployment}"
                                    CanUserAddRows="False"
                                    Margin="10"
                                    Grid.Row="1"
                                    Grid.Column="0">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn 
                                            Binding="{Binding Record, UpdateSourceTrigger=PropertyChanged}"
                                            Header="№"
                                           />
                                        <!--<DataGridTemplateColumn Header="Дата записи">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding CreateAt, UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding CreateAt,UpdateSourceTrigger=PropertyChanged}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>-->
                                        <DataGridTextColumn 
                                            Header="Дата записи"
                                             Binding="{Binding CreateAt,StringFormat='dd.MM.yyyy' ,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridTextColumn
                                            Width="*"
                                            Header="Информация"
                                           Binding="{Binding Name ,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridTextColumn
                                            Width="100"
                                            Header="№ Приказа"
                                           Binding="{Binding Order,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="ЛГПУ"
                                            Binding="{Binding IsUniver ,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="Науч.Пед."
                                            Binding="{Binding IsPedagogical,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="Науч"
                                            Binding="{Binding IsScience,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="Библ."
                                            Binding="{Binding IsLibrary,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="Мед."
                                            Binding="{Binding IsMedical,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="Музей"
                                            Binding="{Binding IsMuseum,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                        <DataGridCheckBoxColumn
                                            Header="Общий"
                                            Binding="{Binding IsOver,UpdateSourceTrigger=PropertyChanged}"
                                            />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter 
                                    Grid.Row="1" Grid.Column="0"
                                    Width="2"/>
                                <StackPanel 
                                        Margin="5"
                                        Grid.Column="1"
                                        Grid.Row="1">
                                    <Label Content="Номер записи "/>
                                    <TextBox Text="{Binding SelectedHistory.Record,UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Информация о записи "/>
                                    <TextBox Text="{Binding SelectedHistory.Name,UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="№ приказа "/>
                                    <TextBox Text="{Binding SelectedHistory.Order,UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата заполнения"/>
                                    <DatePicker 
                                            SelectedDate="{Binding SelectedHistory.CreateAt,UpdateSourceTrigger=PropertyChanged}"
                                            Margin="4 2"
                                            Padding="4 2"/>
                                    <CheckBox 
                                            IsChecked="{Binding SelectedHistory.IsUniver,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}" 
                                            Content="Стаж в ЛГПУ" />
                                    <CheckBox 
                                            IsChecked="{Binding SelectedHistory.IsPedagogical,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}"
                                            Content="Стаж Научно педагогический" />
                                    <CheckBox  
                                            IsChecked="{Binding SelectedHistory.IsScience,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}"
                                            Content="Стаж Научный" />
                                    <CheckBox  
                                            IsChecked="{Binding SelectedHistory.IsLibrary,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}"
                                            Content="Стаж Библиотечный" />
                                    <CheckBox  
                                            IsChecked="{Binding SelectedHistory.IsMedical,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}"
                                            Content="Стаж Медицинский" />
                                    <CheckBox  
                                            IsChecked="{Binding SelectedHistory.IsMuseum,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}"
                                            Content="Стаж Музея" />
                                    <CheckBox  
                                            IsChecked="{Binding SelectedHistory.IsOver,UpdateSourceTrigger=PropertyChanged ,TargetNullValue={x:Null}}"
                                            Content="Общий стаж" />
                                    <StackPanel 
                                        
                                        Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddHistory}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveHistory}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteHistory}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </TabItem>
                <!--#endregion-->
                <!--#region Паспортные данные -->
                <TabItem 
                     FontSize="13"
                    Header="Паспорт">
                    <TabControl>
                        <TabItem
                             FontSize="14"
                            Header="Документы">
                            <Grid Margin="5">
                                <GroupBox 
                            Margin="2"
                            Grid.Row="0"
                            Header="Паспортные данные">
                                    <Grid Margin="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="25"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="25"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="25"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="50"/>
                                            <RowDefinition Height="30"/>
                                            <RowDefinition Height="25"/>
                                        </Grid.RowDefinitions>
                                        <Label 
                                    Grid.Column="0"
                                    Grid.Row="0"
                                    Content="Тип паспорта"/>
                                        <ComboBox
                                        Grid.Column="0"
                                        Grid.Row="1"
                                        ItemsSource="{Binding TypePassports}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SelectedPerson.TypePassport, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                        <Label 
                                    Grid.Column="1" 
                                    Grid.Row="0"
                                    Content="Идентификационный номер"/>
                                        <TextBox 
                                    Text="{Binding SelectedPerson.IdentificationCode , UpdateSourceTrigger=PropertyChanged}"
                                    Grid.Column="1"
                                    Grid.Row="1"></TextBox>
                                        <Grid 
                                            Grid.Column="0"
                                            Grid.Row="2">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0"  Content="Серия паспорта"/>
                                            <Label Grid.Column="1"  Content="Номер паспорта"/>
                                        </Grid>
                                        <Grid
                                            Grid.Row="3"
                                            Grid.Column="0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox Grid.Column="0" Text="{Binding SelectedPerson.SerialPassport , UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBox Grid.Column="1" Text="{Binding SelectedPerson.NumberPassport , UpdateSourceTrigger=PropertyChanged}" />
                                        </Grid>
                                        <Label 
                                    Grid.Column="0"
                                    Grid.Row="4"
                                    Content="Кем выдан паспорт"/>
                                        <TextBox
                                     Grid.ColumnSpan="2" Grid.Column="0"
                                     Grid.Row="5"
                                    Text="{Binding SelectedPerson.OrganizationPassport , UpdateSourceTrigger=PropertyChanged}"
                                    />
                                        <Label 
                                    Grid.Column="1"
                                    Grid.Row="2"
                                    Content="Дата выдачи"/>
                                        <DatePicker
                                     Grid.Column="1"
                                    Grid.Row="3"
                                    Padding="4 1"
                                    Margin="4 4"
                                    SelectedDate="{Binding SelectedPerson.DatePassport , UpdateSourceTrigger=PropertyChanged}"
                                    />
                                        <Label 
                                    Grid.Column="0"
                                    Grid.Row="6"
                                    Content="Фактическое место проживание"/>
                                        <TextBox
                                    Grid.ColumnSpan="2"
                                     Grid.Column="0"
                                    Grid.Row="7"
                                    Text="{Binding SelectedPerson.Adress , UpdateSourceTrigger=PropertyChanged}"
                                    />
                                        <Button
                                            Command="{Binding SaveDataPassport}"
                                            Margin="5"
                                            HorizontalAlignment="Left"
                                            Grid.Column="0"
                                            Grid.Row="8"
                                            Width="120"
                                            Content="Сохранить"/>
                                    </Grid>
                                </GroupBox>
                            </Grid>
                        </TabItem>
                        <TabItem
                             FontSize="13"
                            Header="Удостоверение">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <GroupBox
                                    Margin="5"
                                    Header="Пенсионное удостоверение"
                                    Grid.Row="0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="300"/>
                                        </Grid.ColumnDefinitions>
                                        <DataGrid 
                                            SelectedItem="{Binding SelectedPens}"
                                             FontSize="14"
                                            ScrollViewer.IsDeferredScrollingEnabled="True"
                                            VirtualizingStackPanel.VirtualizationMode="Recycling"
                                            AlternatingRowBackground="#ECEFF1"
                                            AutoGenerateColumns="False"
                                            CanUserAddRows="False"
                                            ItemsSource="{Binding SelectedPerson.ArrayPensioner}"
                                            Grid.Column="0"
                                            Margin="5">
                                            <DataGrid.Resources>
                                                <Style TargetType="{x:Type DataGridCell}">
                                                    <Style.Triggers>
                                                        <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                            <Setter Property="Background" Value="#1e88e5" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                                <CollectionViewSource x:Key="ItemsTypePensioner" Source="{Binding TypePensioner}" />
                                            </DataGrid.Resources>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn
                                                    Header="Номер удостоверения"
                                                    Binding="{Binding Document , UpdateSourceTrigger=PropertyChanged}"/>
                                                <DataGridTemplateColumn Header="Дата выхода на пенсию">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding DateDocument , UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                    <DataGridTemplateColumn.CellEditingTemplate>
                                                        <DataTemplate>
                                                            <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateDocument , UpdateSourceTrigger=PropertyChanged}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellEditingTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridComboBoxColumn 
                                                    Header="Вид пенсии"
                                                    SelectedValueBinding="{Binding Type , UpdateSourceTrigger=PropertyChanged}"
                                                    SelectedValuePath="Name"
                                                    DisplayMemberPath="Name"
                                                    ItemsSource="{Binding Source={StaticResource ItemsTypePensioner}}"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <StackPanel
                                            Margin="5"
                                            Grid.Column="1">
                                            <Label Content="Номер удостоверения "/>
                                            <TextBox Text="{Binding SelectedPens.Document , UpdateSourceTrigger=PropertyChanged}"/>
                                            <Label Content="Дата выхода на пенсию "/>
                                            <DatePicker  
                                                SelectedDate="{Binding SelectedPens.DateDocument , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 2" 
                                                Padding="4 2"/>
                                            <Label Content="Вид пенсии "/>
                                            <ComboBox 
                                                ItemsSource="{Binding TypePensioner}"
                                                DisplayMemberPath="Name"
                                                SelectedValuePath="Name"
                                                SelectedValue="{Binding SelectedPens.Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                                />
                                            <StackPanel Orientation="Horizontal">
                                                <Button 
                                            Command="{Binding AddPensioner}"
                                            Content="Создать"/>
                                                <Button 
                                            Command="{Binding SavePensioner}"
                                            Content="Сохранить"/>
                                                <Button 
                                            Command="{Binding DeletePensioner}"
                                            Content="Удалить"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>
                                <GroupBox
                                    Margin="5"
                                    Header="Удостоверение об инвалидности"
                                    Grid.Row="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="300"/>
                                        </Grid.ColumnDefinitions>
                                        <DataGrid 
                                            SelectedItem="{Binding SelectedInvalid}"
                                            FontSize="14"
                                            ScrollViewer.IsDeferredScrollingEnabled="True"
                                            VirtualizingStackPanel.VirtualizationMode="Recycling"
                                            AlternatingRowBackground="#e1eff9"
                                            IsReadOnly="True"    
                                            AutoGenerateColumns="False"
                                            ItemsSource="{Binding SelectedPerson.ArrayInvalid}"
                                            Grid.Column="0"
                                            Margin="5">
                                            <DataGrid.Resources>
                                                <Style TargetType="{x:Type DataGridCell}">
                                                    <Style.Triggers>
                                                        <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                            <Setter Property="Background" Value="#1e88e5" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.Resources>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn
                                                    Binding="{Binding Document}"
                                                    Header="Номер удостоверения"/>
                                                <DataGridTemplateColumn Header="Дата начала">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding DateStart, StringFormat='dd.MM.yyyy'}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                    <DataGridTemplateColumn.CellEditingTemplate>
                                                        <DataTemplate>
                                                            <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateStart}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellEditingTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTemplateColumn Header="Дата завершения">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding DateEnd, StringFormat='dd.MM.yyyy'}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                    <DataGridTemplateColumn.CellEditingTemplate>
                                                        <DataTemplate>
                                                            <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateEnd}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellEditingTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridCheckBoxColumn 
                                                    Header="Пожизненное"
                                                    Binding="{Binding IsForLife}"/>
                                                <DataGridTextColumn 
                                                    Binding="{Binding Group}"
                                                    Header="Группа"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <StackPanel Grid.Column="1">
                                            <Label Content="Номер удостоверения "/>
                                            <TextBox Text="{Binding SelectedInvalid.Document , UpdateSourceTrigger=PropertyChanged}"/>
                                            <Label Content="Дата начала "/>
                                            <DatePicker  
                                                SelectedDate="{Binding SelectedInvalid.DateStart , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 2" 
                                                Padding="4 2"/>
                                            <Label Content="Дата завершения "/>
                                            <DatePicker  
                                                SelectedDate="{Binding SelectedInvalid.DateEnd , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 2" 
                                                Padding="4 2"/>
                                            <CheckBox
                                                IsChecked="{Binding SelectedInvalid.IsForLife , UpdateSourceTrigger=PropertyChanged}"
                                                Content="Пожизненное"/>
                                            <Label Content="Группа Инвалидности"/>
                                            <TextBox Text="{Binding SelectedInvalid.Group , UpdateSourceTrigger=PropertyChanged}"/>
                                            <StackPanel Orientation="Horizontal">
                                                <Button 
                                            Command="{Binding AddInvalid}"
                                            Content="Создать"/>
                                                <Button 
                                            Command="{Binding SaveInvalid}"
                                            Content="Сохранить"/>
                                                <Button 
                                            Command="{Binding DeleteInvalid}"
                                            Content="Удалить"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="Семейное положение">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedFamily}"
                                     FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    CanUserAddRows="False"
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayFamily}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        <CollectionViewSource x:Key="ItemsTypeFamily" Source="{Binding TypeFamily}" />
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn 
                                            Binding="{Binding FullName , UpdateSourceTrigger=PropertyChanged}"
                                            Header="Ф.И.О."/>
                                        <DataGridTemplateColumn Header="Дата рождения">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Birthday,UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding Birthday,UpdateSourceTrigger=PropertyChanged}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridComboBoxColumn 
                                            Header="Степень родства"
                                            SelectedValueBinding="{Binding Type , UpdateSourceTrigger=PropertyChanged}"
                                            SelectedValuePath="Name"
                                            DisplayMemberPath="Name"
                                            ItemsSource="{Binding Source={StaticResource ItemsTypeFamily}}"/>
                                        <DataGridTextColumn 
                                            Binding="{Binding Description, UpdateSourceTrigger=PropertyChanged}"
                                            Header="Примечание"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel 
                                    Margin="5"
                                    Grid.Column="1">
                                    <Label Content="Ф.И.О родственника "/>
                                    <TextBox Text="{Binding SelectedFamily.FullName , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата рождения"/>
                                    <DatePicker 
                                        Padding="4 2"
                                        Margin="4 2"
                                        SelectedDate="{Binding SelectedFamily.Birthday , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Степень родства"/>
                                    <ComboBox 
                                        ItemsSource="{Binding TypeFamily}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SelectedFamily.Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Примечание"/>
                                    <TextBox Text="{Binding SelectedFamily.Description , UpdateSourceTrigger=PropertyChanged}"/>
                                    <StackPanel Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddFamily}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveFamily}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteFamily}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="История смены фамилии">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedOldSurname}"
                                     FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayChangeSurname}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn 
                                            Binding="{Binding Surname}"
                                            Header="Предыдущая фамилия"/>
                                        <DataGridTemplateColumn Header="Дата измения">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateChange, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateChange}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn 
                                            Binding="{Binding Order}"
                                            Header="Приказ"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel 
                                    Margin="5"
                                    Grid.Column="1">
                                    <Label Content="Предыдущая фамилия "/>
                                    <TextBox Text="{Binding SelectedOldSurname.Surname , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата изменения"/>
                                    <DatePicker 
                                        Padding="4 2"
                                        Margin="4 2"
                                        SelectedDate="{Binding SelectedOldSurname.DateChange , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Номер приказа"/>
                                    <ComboBox 
                                        ItemsSource="{Binding OrderOldSurname}"
                                        SelectedValue="{Binding SelectedOldSurname.Order, UpdateSourceTrigger=PropertyChanged }"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        
                                        />
                                    <StackPanel Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding}"
                                            Content="Создать" 
                                            IsEnabled="False"
                                            />
                                        <Button 
                                            Command="{Binding }"
                                            IsEnabled="False"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteOldSurname}"
                                            
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="Сканы документов">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedDocument}"
                                     FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayDocuments}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="MouseDoubleClick">
                                            <i:InvokeCommandAction 
                                                CommandParameter="{Binding SelectedDocument}"
                                                Command="{ Binding OpenPreview }"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn 
                                            Binding="{Binding Type}"
                                            Header="Тип документа"/>
                                        <DataGridTextColumn 
                                            Binding="{Binding Name}"
                                            Header="Наименование документа"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel 
                                    Margin="5"
                                    Grid.Column="1">
                                    <Label Content="Тип Документа"/>
                                    <ComboBox 
                                        ItemsSource="{Binding TypeDocuments}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SelectedDocument.Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Наименование"/>
                                    <TextBox Text="{Binding SelectedDocument.Name , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Скан документа"/>
                                    <StackPanel 
                                        Orientation="Horizontal">
                                        <TextBox 
                                          
                                            MaxWidth="250"
                                            MinWidth="250"
                                            Text="{Binding UrlDocument , UpdateSourceTrigger=PropertyChanged}"/>
                                        <Button
                                            Command="{Binding SaveUploadDocument}"
                                            Height="22">
                                            <Canvas 
                                                    Height="13"
                                                    Width="13">
                                                <Path
                                                Stretch="Uniform"
                                                Fill="#444444"
                                                Data="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"
                                                Width="13" 
                                                Height="13" />
                                            </Canvas>
                                        </Button>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddDocument}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveDocument}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteDocument}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </TabItem>
                <!--#endregion-->
                <TabItem 
                      FontSize="13"
                    Header="Образование">
                    <TabControl>
                        <TabItem 
                              FontSize="13"
                            Header="Образование">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedEducation}"
                                    FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayEducation}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        <CollectionViewSource x:Key="ItemsTypeEducation" Source="{Binding TypeEducation}" />
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridComboBoxColumn 
                                            Header="Вид обзразования"
                                            SelectedValueBinding="{Binding TypeName , UpdateSourceTrigger=PropertyChanged}"
                                            SelectedValuePath="TypeName"
                                            DisplayMemberPath="TypeName"
                                            ItemsSource="{Binding Source={StaticResource ItemsTypeEducation}}"/>
                                        <DataGridTextColumn
                                            Width="100"
                                            Binding="{Binding Institution ,UpdateSourceTrigger=PropertyChanged }"
                                            Header="Уч.Заведения"/>
                                        <DataGridTextColumn 
                                             Width="100"
                                            Binding="{Binding Specialty ,UpdateSourceTrigger=PropertyChanged}"
                                            Header="Специальность"/>
                                        <DataGridTextColumn
                                             Width="100"
                                            Binding="{Binding Qualification,UpdateSourceTrigger=PropertyChanged}"
                                            Header="Квалификация"/>
                                        <DataGridCheckBoxColumn 
                                             Width="80"
                                            Binding="{Binding IsActual,UpdateSourceTrigger=PropertyChanged}"
                                            Header="Основное"/>
                                        <DataGridTextColumn
                                            Binding="{Binding Name,UpdateSourceTrigger=PropertyChanged}"
                                            Header="Номер Диплома"/>
                                        <DataGridTemplateColumn Header="Дата выдачи">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateIssue,UpdateSourceTrigger=PropertyChanged, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateIssue,UpdateSourceTrigger=PropertyChanged}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter 
                                    Grid.Column="0"
                                    Width="2"/>
                                <StackPanel 
                                    Margin="5"
                                    Grid.Column="1">
                                    <Label Content="Вид образования"/>
                                    <ComboBox 
                                        ItemsSource="{Binding TypeEducation}"
                                        DisplayMemberPath="TypeName"
                                        SelectedValuePath="TypeName"
                                        SelectedValue="{Binding SelectedEducation.TypeName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Наименование уч. заведения"/>
                                    <TextBox Text="{Binding SelectedEducation.Institution , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Специальность"/>
                                    <TextBox Text="{Binding SelectedEducation.Specialty , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Квалификация"/>
                                    <TextBox Text="{Binding SelectedEducation.Qualification , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Номер диплома/Свидельства"/>
                                    <TextBox Text="{Binding SelectedEducation.Name , UpdateSourceTrigger=PropertyChanged}"/>
                                    <CheckBox Content="Основное" IsChecked="{Binding SelectedEducation.IsActual , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата выдачи"/>
                                    <DatePicker
                                        Margin="4 2"
                                        Padding="4 2"
                                        SelectedDate="{Binding SelectedEducation.DateIssue ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <StackPanel Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddEducation}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveEducation}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteEducation}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="Повышение квалификации">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedQualification}"
                                    FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayQualification}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn 
                                            Binding="{Binding NameCourse}"
                                            Header="Наименование курсов"/>
                                        <DataGridTemplateColumn Header="Дата начала">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateBegin, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateBegin}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Дата окончания">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateEnd, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateEnd}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Дата выдачи">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateIssue, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateIssue}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn 
                                            Binding="{Binding Place}"
                                            Header="Место прохождения"/>
                                        <DataGridTextColumn 
                                            Binding="{Binding Certificate}"
                                            Header="Номер свидельства"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter 
                                    Grid.Column="0" 
                                    Width="2"/>
                                <StackPanel Grid.Column="1">
                                    <Label Content="Наименование курсов" />
                                    <TextBox Text="{Binding SelectedQualification.NameCourse , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата начала" />
                                    <DatePicker 
                                        Margin="5 0 5 0"
                                        SelectedDate="{Binding SelectedQualification.DateBegin , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата окончания" />
                                    <DatePicker 
                                        Margin="5 0 5 0"
                                        SelectedDate="{Binding SelectedQualification.DateEnd , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Дата выдачи" />
                                    <DatePicker 
                                        Margin="5 0 5 0"
                                        SelectedDate="{Binding SelectedQualification.DateIssue , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Место прохождения"/>
                                    <TextBox Text="{Binding SelectedQualification.Place , UpdateSourceTrigger=PropertyChanged}"/>
                                    <Label Content="Номер свидельства"/>
                                    <TextBox Text="{Binding SelectedQualification.Certificate , UpdateSourceTrigger=PropertyChanged}"/>
                                    <StackPanel Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddQualification}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveQualification}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteQualification}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="Науч. степень/Уч.звание">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="280"/>
                                </Grid.RowDefinitions>
                                <GroupBox
                                    Margin="3"
                                    Header="Научная степень"
                                    Grid.Row="0">
                                    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="300"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <DataGrid 
                                            SelectedItem="{Binding SeletedDegree}"
                                            FontSize="14"
                                            ScrollViewer.IsDeferredScrollingEnabled="True"
                                            VirtualizingStackPanel.VirtualizationMode="Recycling"
                                            AlternatingRowBackground="#ECEFF1"
                                            IsReadOnly="True"    
                                            AutoGenerateColumns="False"
                                            ItemsSource="{Binding SelectedPerson.ArrayScientificDegree}"
                                            Grid.Column="0"
                                            Margin="5">
                                                <DataGrid.Resources>
                                                    <Style TargetType="{x:Type DataGridCell}">
                                                        <Style.Triggers>
                                                            <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                                <Setter Property="Background" Value="#1e88e5" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </DataGrid.Resources>
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn
                                                        Width="*"
                                                    Header="Степень"
                                                    Binding="{Binding TypeScientific}"/>
                                                    <DataGridTemplateColumn Header="Дата утверждения">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding DateOfIssue, StringFormat='dd.MM.yyyy'}"/>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateOfIssue}"/>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                            <Grid 
                                                 Margin="5"
                                                Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="53"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <StackPanel 
                                                    Grid.Row="0"
                                                    Grid.ColumnSpan="2">
                                                    <Label Content="Степень "/>
                                                    <ComboBox 
                                                    ItemsSource="{Binding TypeDegree}"
                                                    DisplayMemberPath="Name"
                                                    SelectedValuePath="Name"
                                                    SelectedValue="{Binding SeletedDegree.TypeScientific, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                                    />
                                                </StackPanel>
                                                <StackPanel  
                                                    Grid.Column="0"
                                                    Grid.Row="1">
                                                    <Label 
                                                    Content="Серия и номер диплома"/>
                                                    <TextBox 
                                                    Text="{Binding SeletedDegree.Document , UpdateSourceTrigger=PropertyChanged}"/>
                                                </StackPanel>
                                                <StackPanel  
                                                    Grid.Column="1"
                                                    Grid.Row="1">
                                                    <Label Content="Дата утверждения"/>
                                                    <DatePicker  
                                                SelectedDate="{Binding SeletedDegree.DateOfIssue , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 0" 
                                                Padding="4 0"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="2"
                                                    Grid.ColumnSpan="2" Grid.Column="0">
                                                    <Label Content="Область науки, по которой присуждена научная степень"/>
                                                    <TextBox Text="{Binding SeletedDegree.ScientificBranch}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="3"
                                                    Grid.ColumnSpan="2" Grid.Column="0">
                                                    <Label Content="Специальность, по которой подготовлена диссертация"/>
                                                    <TextBox Text="{Binding SeletedDegree.ScientificSpecialty}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="4"
                                                    Grid.ColumnSpan="2" Grid.Column="0">
                                                    <Label Content="Тема диссертации"/>
                                                    <TextBox Text="{Binding SeletedDegree.Dissertation}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="5"
                                                    Grid.Column="0">
                                                    <Label Content="Место присвоения"/>
                                                    <TextBox Text="{Binding SeletedDegree.Place}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="5"
                                                    Grid.Column="1">
                                                    <Label Content="Город присвоения"/>
                                                    <TextBox Text="{Binding SeletedDegree.City}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="6"
                                                    Grid.ColumnSpan="2" Grid.Column="0">
                                                    <Label Content="Должность и предприятие где работал после получения диплома"/>
                                                    <TextBox Text="{Binding SeletedDegree.JobAfter}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    Grid.Row="7"
                                                    Grid.Column="0">
                                                    <Label Content="Количество научн.работ"/>
                                                    <TextBox Text="{Binding SeletedDegree.CountScientific}"/>
                                                </StackPanel>
                                                <StackPanel 
                                                    VerticalAlignment="Bottom"
                                                    HorizontalAlignment="Right"
                                                    Grid.Row="8"
                                                    Grid.Column="1"
                                                    Orientation="Horizontal">
                                                    <Button Command="{Binding AddScience}" Content="Создать"/>
                                                    <Button Command="{Binding SaveScience}" Content="Сохранить"/>
                                                    <Button Command="{Binding DeleteScience}" Content="Удалить"/>
                                                </StackPanel>
                                            </Grid>
                                            <!--<StackPanel
                                            Margin="5"
                                            Grid.Column="1"><Label Content="Серия и номер документа"/><TextBox Text="{Binding SeletedDegree.Document , UpdateSourceTrigger=PropertyChanged}"/><Label Content="Степень "/><ComboBox 
                                                ItemsSource="{Binding TypeDegree}"
                                                DisplayMemberPath="Name"
                                                SelectedValuePath="Name"
                                                SelectedValue="{Binding SeletedDegree.TypeScientific, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                                /><Label Content="Дата утверждения"/><DatePicker  
                                                SelectedDate="{Binding SeletedDegree.DateOfIssue , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 2" 
                                                Padding="4 2"/><Label Content="Область науки, по которой присуждена научная степень"/><TextBox Text="{Binding SeletedDegree.ScientificBranch}"/><Label Content="Специальность, по которой подготовлена диссертация"/><TextBox Text="{Binding SeletedDegree.ScientificSpecialty}"/><Label Content="Тема диссертации"/><TextBox Text="{Binding SeletedDegree.Dissertation}"/><Label Content="Место присвоения"/><TextBox Text="{Binding SeletedDegree.Place}"/><Label Content="Город присвоения"/><TextBox Text="{Binding SeletedDegree.City}"/><TextBox Text="{Binding SeletedDegree.JobAfter}"/><Label Content="Количество научн.работ"/><TextBox Text="{Binding SeletedDegree.CountScientific}"/><StackPanel Orientation="Horizontal"><Button Command="{Binding AddScience}" Content="Создать"/><Button Command="{Binding SaveScience}" Content="Сохранить"/><Button Command="{Binding DeleteScience}" Content="Удалить"/></StackPanel></StackPanel>-->
                                        </Grid>
                                    </ScrollViewer>
                                </GroupBox>
                                <GroupBox
                                    Margin="3"
                                    Header="Ученое звание"
                                    Grid.Row="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="300"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <DataGrid 
                                            SelectedItem="{Binding SelectedTitle}"
                                            FontSize="14"
                                            ScrollViewer.IsDeferredScrollingEnabled="True"
                                            VirtualizingStackPanel.VirtualizationMode="Recycling"
                                            AlternatingRowBackground="#ECEFF1"
                                            IsReadOnly="True"    
                                            AutoGenerateColumns="False"
                                            ItemsSource="{Binding SelectedPerson.ArrayAcademicTitle}"
                                            Grid.Column="0"
                                            Margin="5">
                                            <DataGrid.Resources>
                                                <Style TargetType="{x:Type DataGridCell}">
                                                    <Style.Triggers>
                                                        <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                            <Setter Property="Background" Value="#1e88e5" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.Resources>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn
                                                    Width="*"
                                                    Binding="{Binding TypeRank}"
                                                    Header="Звание"/>
                                                <DataGridTemplateColumn Header="Дата присвоения">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding DateIssue, StringFormat='dd.MM.yyyy'}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                    <DataGridTemplateColumn.CellEditingTemplate>
                                                        <DataTemplate>
                                                            <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateIssue}"/>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellEditingTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                        <Grid Grid.Column="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="53"/>
                                                <RowDefinition Height="53"/>
                                                <RowDefinition Height="53"/>
                                                <RowDefinition Height="53"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <StackPanel 
                                                Grid.Row="0"
                                                Grid.ColumnSpan="2">
                                                <Label Content="Звание"/>
                                                <ComboBox
                                                IsEditable="True"
                                                ItemsSource="{Binding TypeTitle}"
                                                DisplayMemberPath="Name"
                                                SelectedValuePath="Name"
                                                SelectedValue="{Binding SelectedTitle.TypeRank, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                            />
                                            </StackPanel>
                                            <StackPanel 
                                                Grid.Row="1"
                                                Grid.Column="0">
                                                <Label Content="Серия и номер диплома"/>
                                                <TextBox Text="{Binding SelectedTitle.Document , UpdateSourceTrigger=PropertyChanged}"/>
                                            </StackPanel>
                                            <StackPanel 
                                                Grid.Row="1"
                                                Grid.Column="1">
                                                <Label Content="Дата присвоения "/>
                                                <DatePicker  
                                                SelectedDate="{Binding SelectedTitle.DateIssue , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 0" 
                                                Padding="4 0"/>
                                            </StackPanel>
                                            <StackPanel 
                                                Grid.Row="2"
                                                Grid.ColumnSpan="2" Grid.Column="0">
                                                <Label Content="Кафедра"/>
                                                <TextBox Text="{Binding SelectedTitle.Department , UpdateSourceTrigger=PropertyChanged}"/>
                                            </StackPanel>
                                            <StackPanel 
                                                Grid.Row="3"
                                                Grid.ColumnSpan="2" Grid.Column="0">
                                                <Label Content="Место присвоения"/>
                                                <TextBox Text="{Binding SelectedTitle.Place , UpdateSourceTrigger=PropertyChanged}"/>
                                            </StackPanel>
                                            <StackPanel 
                                                VerticalAlignment="Bottom"
                                                HorizontalAlignment="Right"
                                                Grid.Column="1"
                                                Grid.Row="4"
                                                Orientation="Horizontal">
                                                <Button 
                                                    Command="{Binding AddTile}"
                                                    Content="Создать"/>
                                                <Button 
                                                    Command="{Binding SaveTile}"
                                                    Content="Сохранить"/>
                                                <Button 
                                                    Command="{Binding DeleteTitle}"
                                                    Content="Удалить"/>
                                            </StackPanel>
                                        </Grid>
                                        <!--<StackPanel Grid.Column="1"><Label Content="Звание"/><ComboBox
                                                IsEditable="True"
                                                ItemsSource="{Binding TypeTitle}"
                                                DisplayMemberPath="Name"
                                                SelectedValuePath="Name"
                                                SelectedValue="{Binding SelectedTitle.TypeRank, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                            /><Label Content="Серия и номер диплома"/><TextBox Text="{Binding SelectedTitle.Document , UpdateSourceTrigger=PropertyChanged}"/><Label Content="Дата присвоения "/><DatePicker  
                                                SelectedDate="{Binding SelectedTitle.DateIssue , UpdateSourceTrigger=PropertyChanged}"
                                                Margin="4 2" 
                                                Padding="4 2"/><Label Content="Кафедра"/><TextBox Text="{Binding SelectedTitle.Department , UpdateSourceTrigger=PropertyChanged}"/><Label Content="Место присвоения"/><TextBox Text="{Binding SelectedTitle.Place , UpdateSourceTrigger=PropertyChanged}"/><StackPanel Orientation="Horizontal"><Button 
                                                    Command="{Binding AddTile}"
                                                    Content="Создать"/><Button 
                                                    Command="{Binding SaveTile}"
                                                    Content="Сохранить"/><Button 
                                                    Command="{Binding DeleteTitle}"
                                                    Content="Удалить"/></StackPanel></StackPanel>-->
                                    </Grid>
                                </GroupBox>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="Награждение/Поощрение">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedRewarding}"
                                    FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayRewarding}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn
                                            Width="100"
                                            Header="Вид нагр./поощ."
                                            Binding="{Binding Type}"
                                            />
                                        <DataGridTextColumn
                                            Header="Приказ"
                                            Binding="{Binding Order}"
                                            />
                                        <DataGridTemplateColumn Header="Дата получения">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateIssue, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateIssue}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn
                                            Header="Документ(Внешний приказ)"
                                            Binding="{Binding NumberDocumet}"
                                            />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <StackPanel 
                                    Margin="5"
                                    Grid.Column="1">
                                    <Label Content="Вид награждения"/>
                                    <ComboBox
                                        IsEditable="True"
                                        ItemsSource="{Binding TypeRewarding}"
                                        DisplayMemberPath="Type"
                                        SelectedValuePath="Type"
                                        SelectedValue="{Binding SelectedRewarding.Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Приказ награждения"/>
                                    <ComboBox 
                                        IsEditable="True"
                                        ItemsSource="{Binding OrderRewarding}"
                                        DisplayMemberPath="Order"
                                        SelectedValuePath="IdOrder"
                                        SelectedValue="{Binding SelectedRewarding.IdOrder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                    />
                                    <Label Content="{Binding SelectedRewarding.IdType}"/>
                                    <DatePicker
                                        Margin="4 2"
                                        Padding="4 2"
                                        SelectedDate="{Binding SelectedRewarding.DateIssue}"/>
                                    <Label Content="Документ (Внешний приказ)"/>
                                    <TextBox Text="{Binding SelectedRewarding.NumberDocumet}"/>
                                    <StackPanel Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddRewarding}"
                                            Content="Создать"/>
                                        <Button 
                                            Command="{Binding SaveRewarding}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteRewarding}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                              FontSize="13"
                            Header="Академик/Член-корр.">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SeletedMemberAcademic}"
                                    FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayMeberAcademic}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        <CollectionViewSource x:Key="ItemsTypeRank" Source="{Binding TypeRanks}" />
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridComboBoxColumn 
                                            Header="Вид"
                                            Width="90"
                                            SelectedValueBinding="{Binding Name}"
                                            SelectedValuePath="Name"
                                            DisplayMemberPath="Name"
                                            ItemsSource="{Binding Source={StaticResource ItemsTypeRank}}"/>
                                        <DataGridTextColumn 
                                            Binding="{Binding NameAcademic}"
                                            Header="Наименование Академии"/>
                                        <DataGridTextColumn 
                                            Binding="{Binding Document}"
                                            Header="Номер Диплома"/>
                                        <DataGridTemplateColumn Header="Дата избрания">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Datebegin, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding Datebegin}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter 
                                    Width="2"
                                    Grid.Column="0"/>
                                <StackPanel 
                                    Grid.Column="1">
                                    <Label Content="Вид Академика"/>
                                    <ComboBox 
                                        ItemsSource="{Binding TypeRanks}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SeletedMemberAcademic.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Номер Диплома"/>
                                    <TextBox Text="{Binding SeletedMemberAcademic.Document}"/>
                                    <Label Content="Наименование Академии"/>
                                    <TextBox Text="{Binding SeletedMemberAcademic.NameAcademic}"/>
                                    <Label Content="Дата избрания"/>
                                    <DatePicker
                                        Margin="4 2"
                                        SelectedDate="{Binding SeletedMemberAcademic.Datebegin}"/>
                                    <StackPanel 
                                        Margin="0 5 5 0"
                                        Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddMember}"
                                            Content="Создать"/>
                                        <Button
                                            Command="{Binding SaveMember}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteMember}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem 
                             FontSize="13"
                            Header="Медицинское образование">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="300"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid 
                                    SelectedItem="{Binding SelectedMedical}"
                                    FontSize="14"
                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                                    AlternatingRowBackground="#ECEFF1"
                                    IsReadOnly="True"    
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding SelectedPerson.ArrayMedical}"
                                    Grid.Column="0"
                                    Margin="5">
                                    <DataGrid.Resources>
                                        <Style TargetType="{x:Type DataGridCell}">
                                            <Style.Triggers>
                                                <Trigger Property="DataGridCell.IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1e88e5" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn 
                                            Binding="{Binding Category}"
                                            Header="Категория"/>
                                        <DataGridTextColumn 
                                            Binding="{Binding Name}"
                                            Header="Наименование"/>
                                        <DataGridTemplateColumn Header="Дата начала">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateStart, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2" 
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateStart}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Header="Дата окончания">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DateEnd, StringFormat='dd.MM.yyyy'}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <DatePicker 
                                                        Margin="4 2"
                                                        Padding="4 2"
                                                        SelectedDate="{Binding DateEnd}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter 
                                    Width="2"
                                    Grid.Column="0"/>
                                <StackPanel 
                                    Grid.Column="1">
                                    <Label Content="{Binding SelectedMedical.Id}"/>
                                    <ComboBox 
                                        ItemsSource="{Binding MedicalCategory}"
                                        DisplayMemberPath="Name"
                                        SelectedValuePath="Name"
                                        SelectedValue="{Binding SelectedMedical.Category, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                                        />
                                    <Label Content="Наименование"/>
                                    <TextBox Text="{Binding SelectedMedical.Name}"/>
                                    <Label Content="Дата начала"/>
                                    <DatePicker SelectedDate="{Binding SelectedMedical.DateStart}"/>
                                    <Label Content="Дата окончания"/>
                                    <DatePicker SelectedDate="{Binding SelectedMedical.DateEnd}"/>
                                    <StackPanel 
                                        Margin="0 5 5 0"
                                        Orientation="Horizontal">
                                        <Button 
                                            Command="{Binding AddMedical}"
                                            Content="Создать"/>
                                        <Button
                                            Command="{Binding SaveMedical}"
                                            Content="Сохранить"/>
                                        <Button 
                                            Command="{Binding DeleteMedical}"
                                            Content="Удалить"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </TabItem>
            </TabControl>
            <StackPanel 
                Grid.Row="3"
                Orientation="Horizontal">
                <Button 
                    Margin="5 0 0 5"
                    Command="{Binding OpenReportCard}"
                    Content="Личная карта"/>
                <Button 
                    Margin="5 0 0 5"
                    Command="{Binding OpenreportSpravka}"
                    Content="Справка с места работы"/>
                <Button 
                    Margin="5 0 0 5"
                    Command="{Binding OpenreportObjective}"
                    Content="Объективка"/>
                <Button 
                    Margin="5 0 0 5"
                    Command="{Binding OpenExperience}"
                    Content="Стаж сотрудника"/>
            </StackPanel>
        </Grid>
        <!--#endregion-->
    </Grid>
</UserControl>
